<!-- Service Features 2 Section -->
{% set title = widget.data.section_title or 'مزايا الخدمة' %}
<section id="serviceFeaturesSection" class="my-12 md:my-16 px-2 mx-2.5 md:mx-20 service-features-section">
    <!-- Iconify Script -->
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>

    <div>
        <h1 class="text-2xl md:text-3xl font-bold text-black mb-10 md:mb-12 text-center">{{ title }}</h1>
        {% set hasBlocks = widget.blocks and (widget.blocks | length) > 0 %}
        {% set blocksOrdered = (widget.data.reverse_order) and (widget.blocks | reverse) or widget.blocks %}
        {% if hasBlocks %}
        
        <!-- Desktop Layout -->
        <div class="hidden sm:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-10 md:gap-10">
            {% for block in blocksOrdered %}
            <div class="text-center flex flex-col items-center p-6 rounded-2xl hover:shadow-xl transition-all duration-300 hover:-translate-y-2">
                <div class="mb-2">
                    {% set imgUrl = block.data and block.data.icon and block.data.icon.fileUrl %}
                    {% if imgUrl %}
                    <img src="{{ imgUrl }}" alt="{{ (block.data and block.data.alt) or (block.data and block.data.title) or (block.settings and block.settings.title) or 'icon' }}" class="w-16 h-16 mx-auto object-contain" />
                    {% else %}
                    {% set cardTitle = (block.data and block.data.title) or (block.settings and block.settings.title) %}
                    {% if cardTitle == 'خدمة مخصصة' %}
                    <div class="w-16 h-16 mx-auto flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" class="text-black"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5"><path d="M18.709 3.495C16.817 2.554 14.5 2 12 2s-4.816.554-6.709 1.495c-.928.462-1.392.693-1.841 1.419S3 6.343 3 7.748v3.49c0 5.683 4.542 8.843 7.173 10.196c.734.377 1.1.566 1.827.566s1.093-.189 1.827-.566C16.457 20.08 21 16.92 21 11.237V7.748c0-1.405 0-2.108-.45-2.834s-.913-.957-1.841-1.419"/><path d="M12 9v1m-1-.5a1 1 0 1 0 2 0a1 1 0 0 0-2 0"/><path d="M12.75 14h-1.5l.75-3.5z"/></g></svg>
                    </div>
                    {% elif cardTitle == 'العمل على مدار الساعة' %}
                    <div class="w-16 h-16 mx-auto flex items-center justify-center">
                        <iconify-icon icon="iconamoon:clock-thin" width="67" height="67" class="text-black icon-thin"></iconify-icon>
                    </div>
                    {% elif cardTitle == 'أسعار مناسبة' %}
                    <div class="w-16 h-16 mx-auto flex items-center justify-center">
                        <iconify-icon icon="lsicon:setting-outline" width="67" height="67" class="text-black icon-thin"></iconify-icon>
                    </div>
                    {% elif cardTitle == 'دقة مواعيد' %}
                    <div class="w-16 h-16 mx-auto flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" class="text-black"><path fill="none" stroke="currentColor" stroke-width="0.5" d="M9.153 5.408C10.42 3.136 11.053 2 12 2s1.58 1.136 2.847 3.408l.328.588c.36.646.54.969.82 1.182s.63.292 1.33.45l.636.144c2.46.557 3.689.835 3.982 1.776c.292.94-.546 1.921-2.223 3.882l-.434.507c-.476.557-.715.836-.822 1.18c-.107.345-.071.717.001 1.46l.066.677c.253 2.617.38 3.925-.386 4.506s-1.918.051-4.22-1.009l-.597-.274c-.654-.302-.981-.452-1.328-.452s-.674.15-1.328.452l-.596.274c-2.303 1.06-3.455 1.59-4.22 1.01c-.767-.582-.64-1.89-.387-4.507l.066-.676c.072-.744.108-1.116 0-1.46c-.106-.345-.345-.624-.821-1.18l-.434-.508c-1.677-1.96-2.515-2.941-2.223-3.882S3.58 8.328 6.04 7.772l.636-.144c.699-.158 1.048-.237 1.329-.45s.46-.536.82-1.182z"/></svg>
                    </div>
                    {% else %}
                    <div class="w-16 h-16 mx-auto bg-gray-200 rounded-full flex items-center justify-center">
                        <i class="{{ (block.settings and block.settings.icon_class) or 'ph-thin ph-star' }} text-4xl text-gray-400"></i>
                    </div>
                    {% endif %}
                    {% endif %}
                </div>

                {% set cardTitle = (block.data and block.data.title) or (block.settings and block.settings.title) %}
                {% if cardTitle %}
                <h3 class="text-xl font-bold text-dark mt-5 mb-3 text-center">{{ cardTitle }}</h3>
                {% endif %}
                {% set cardDesc = (block.data and block.data.description) or (block.settings and block.settings.description) %}
                {% if cardDesc %}
                <p class="text-m text-gray-600 leading-relaxed text-center max-w-xs mx-auto">{{ cardDesc }}</p>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        
        <!-- Mobile Layout: Swiper -->
        <div class="sm:hidden relative">
            <div class="swiper serviceFeaturesSwiper">
                <div class="swiper-wrapper">
                    {% for block in blocksOrdered %}
                    <div class="swiper-slide">
                        <div class="text-center flex flex-col items-center p-6 rounded-2xl hover:shadow-xl transition-all duration-300 hover:-translate-y-2">
                            <div class="mb-2">
                                {% set imgUrl = block.data and block.data.icon and block.data.icon.fileUrl %}
                                {% if imgUrl %}
                                <img src="{{ imgUrl }}" alt="{{ (block.data and block.data.alt) or (block.data and block.data.title) or (block.settings and block.settings.title) or 'icon' }}" class="w-16 h-16 mx-auto object-contain" />
                                {% else %}
                                {% set cardTitle = (block.data and block.data.title) or (block.settings and block.settings.title) %}
                                {% if cardTitle == 'خدمة مخصصة' %}
                                <div class="w-16 h-16 mx-auto flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" class="text-black"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5"><path d="M18.709 3.495C16.817 2.554 14.5 2 12 2s-4.816.554-6.709 1.495c-.928.462-1.392.693-1.841 1.419S3 6.343 3 7.748v3.49c0 5.683 4.542 8.843 7.173 10.196c.734.377 1.1.566 1.827.566s1.093-.189 1.827-.566C16.457 20.08 21 16.92 21 11.237V7.748c0-1.405 0-2.108-.45-2.834s-.913-.957-1.841-1.419"/><path d="M12 9v1m-1-.5a1 1 0 1 0 2 0a1 1 0 0 0-2 0"/><path d="M12.75 14h-1.5l.75-3.5z"/></g></svg>
                                </div>
                                {% elif cardTitle == 'العمل على مدار الساعة' %}
                                <div class="w-16 h-16 mx-auto flex items-center justify-center">
                                    <iconify-icon icon="iconamoon:clock-thin" width="67" height="67" class="text-black icon-thin"></iconify-icon>
                                </div>
                                {% elif cardTitle == 'أسعار مناسبة' %}
                                <div class="w-16 h-16 mx-auto flex items-center justify-center">
                                    <iconify-icon icon="lsicon:setting-outline" width="67" height="67" class="text-black icon-thin"></iconify-icon>
                                </div>
                                {% elif cardTitle == 'دقة مواعيد' %}
                                <div class="w-16 h-16 mx-auto flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" class="text-black"><path fill="none" stroke="currentColor" stroke-width="0.5" d="M9.153 5.408C10.42 3.136 11.053 2 12 2s1.58 1.136 2.847 3.408l.328.588c.36.646.54.969.82 1.182s.63.292 1.33.45l.636.144c2.46.557 3.689.835 3.982 1.776c.292.94-.546 1.921-2.223 3.882l-.434.507c-.476.557-.715.836-.822 1.18c-.107.345-.071.717.001 1.46l.066.677c.253 2.617.38 3.925-.386 4.506s-1.918.051-4.22-1.009l-.597-.274c-.654-.302-.981-.452-1.328-.452s-.674.15-1.328.452l-.596.274c-2.303 1.06-3.455 1.59-4.22 1.01c-.767-.582-.64-1.89-.387-4.507l.066-.676c.072-.744.108-1.116 0-1.46c-.106-.345-.345-.624-.821-1.18l-.434-.508c-1.677-1.96-2.515-2.941-2.223-3.882S3.58 8.328 6.04 7.772l.636-.144c.699-.158 1.048-.237 1.329-.45s.46-.536.82-1.182z"/></svg>
                                </div>
                                {% else %}
                                <div class="w-16 h-16 mx-auto bg-gray-200 rounded-full flex items-center justify-center">
                                    <i class="{{ (block.settings and block.settings.icon_class) or 'ph-thin ph-star' }} text-4xl text-gray-400"></i>
                                </div>
                                {% endif %}
                                {% endif %}
                            </div>
                            {% set cardTitle = (block.data and block.data.title) or (block.settings and block.settings.title) %}
                            {% if cardTitle %}
                            <h3 class="text-xl font-bold text-dark mt-5 mb-3 text-center">{{ cardTitle }}</h3>
                            {% endif %}
                            {% set cardDesc = (block.data and block.data.description) or (block.settings and block.settings.description) %}
                            {% if cardDesc %}
                            <p class="text-m text-gray-600 leading-relaxed text-center max-w-xs mx-auto">{{ cardDesc }}</p>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</section>

<!-- Swiper CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

<!-- Swiper JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const serviceFeaturesSwiperElement = document.querySelector('.serviceFeaturesSwiper');
    if (serviceFeaturesSwiperElement) {
        const serviceFeaturesSwiper = new Swiper('.serviceFeaturesSwiper', {
            slidesPerView: 1,
            spaceBetween: 16,
            loop: true,
            grabCursor: true,
            centeredSlides: true,
            autoplay: { 
                delay: 3500, 
                disableOnInteraction: false 
            },
            breakpoints: {
                320: { slidesPerView: 1, spaceBetween: 8, centeredSlides: true },
                480: { slidesPerView: 1, spaceBetween: 12, centeredSlides: true },
                640: { slidesPerView: 1, spaceBetween: 16, centeredSlides: true },
            }
        });
    }
});
</script>

<style>
/* General thin icons */
.service-features-section iconify-icon,
.service-features-section .icon-thin {
    stroke-width: 0.2 !important;
    opacity: 0.9;
    -webkit-font-smoothing: antialiased;
    transform: translateZ(0);
}

/* Extra-thin style for selected icons only */
.service-features-section .custom-thin {
    stroke-width: 0.2 !important;
    opacity: 0.8;
    filter: contrast(1.1) brightness(1.05);
    transition: all 0.3s ease;
}

.service-features-section .custom-thin:hover {
    opacity: 1;
    transform: scale(1.05);
}

/* Mobile Swiper Styling */
@media (max-width: 640px) {
    .serviceFeaturesSwiper {
        overflow: hidden;
    }
    
    .serviceFeaturesSwiper .swiper-slide {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100% !important;
    }
    
    .serviceFeaturesSwiper .swiper-slide > div {
        max-width: 300px;
        width: 100%;
        margin: 0 auto;
    }
    
    .serviceFeaturesSwiper .swiper-slide:not(.swiper-slide-active) {
        opacity: 0;
        transform: scale(0.8);
    }
    
    .serviceFeaturesSwiper .swiper-slide-active {
        opacity: 1;
        transform: scale(1);
    }
}
</style>
